{% extends 'base.html' %}

{% block content %}

<main class="container py-5 mt-5">

    <div class="row mt-5">

        <div class="col-md-6 offset-md-3">

            <h1 class="text-center display-5 text-green">Solicitudes de materiales</h1>

            <ul style="list-style-type: none;" class="list-group mt-4">
                {% for solicitud in solicitudes %}
                <a class="list-group-item my-2 border rounded" href="{% url 'material_detail' solicitud.id %}">
                    <div class="d-flex justify-content-between gap-3 my-2">
                        <h4 class="my-0">{{solicitud.usuario.get_full_name}}</h4>
                        <p class="mt-1"><b>Folio solicitud:</b> {{solicitud.id}}</p>
                    </div>
                    <div class="d-flex justify-content-between gap-3">
                        <p><b>Empresa:</b> {{solicitud.empresa}}</p>
                        <p><b>Fecha:</b> {{solicitud.fecha}}</p>
                    </div>
                    {% if solicitud.pendiente %}
                    <p class="text-success">üïê Pendiente aprobaci√≥n</p>
                    {% endif %}
                    {% if solicitud.compras %}
                    <p class="text-success">‚úÖ Aprobado por compras</p>
                    {% endif %}
                    {% if solicitud.rechazado_compras %}
                    <p class="text-danger">‚ùå Rechazado por compras</p>
                    <p class="text-danger"><b>Comentario:</b> {{solicitud.comentarios}}</p>
                    {% endif %}
                    {% if solicitud.finanzas %}
                    <p class="text-success">‚úÖ Aprobado por finanzas</p>
                    {% endif %}
                    {% if solicitud.rechazado_finanzas %}
                    <p class="text-danger">‚ùå Rechazado por finanzas</p>
                    <p class="text-danger"><b>Comentario:</b> {{solicitud.comentarios}}</p>
                    {% endif %}
                    {% if solicitud.sistemas %}
                    <p class="text-success">‚úÖ Aprobado por sistemas</p>
                    {% endif %}
                    {% if solicitud.rechazado_sistemas %}
                    <p class="text-danger">‚ùå Rechazado por sistemas</p>
                    <p class="text-danger"><b>Comentario:</b> {{solicitud.comentarios}}</p>
                    {% endif %}

                    {% for cambio in historial %}
                        {% if solicitud.id == cambio.id_solicitud %}
                            <p style="font-size: 0.8rem; color: gray;"><i>üî∏{{cambio}} - {{cambio.fecha}}</i></p>
                        {% endif %}
                    {% endfor %}
                </a>
                {% endfor %}
            </ul>

        </div>

    </div>

</main>

{% endblock %}